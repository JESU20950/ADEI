# Load Required Packages: to be increased over the course
options(contrasts=c("contr.treatment","contr.treatment"))
requiredPackages <- c("missMDA","chemometrics","mvoutlier","effects","FactoMineR","car", "factoextra","RColorBrewer","ggplot2","dplyr","ggmap","ggthemes","knitr","ggpubr", "corrplot", "moments")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]
if(length(missingPackages)) install.packages(missingPackages)
lapply(requiredPackages, require, character.only = TRUE)
# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
#setwd("C:/Users/carle/Desktop/ADEI2")
#filepath<-"C:/Users/carle/Desktop/ADEI2/"
setwd("~/Desktop/ADEI/Labs/DeliverableIII")
df <- read.table("Deliverable1.csv",header=T, sep=",");
vars_dis <- c("VendorID", "Payment_type", "Store_and_fwd_flag",  "RateCodeID", "f.Extra", "f.MTA_tax", "f.Improvement_surcharge", "lpep_pickup_period", "Trip_type", "lpep_pickup_date", "multiouts", "f.espeed", "f.tlenkm", "f.traveltime", "f.distHaversine", "AnyToll", "f.Fare_amount", "f.Passenger_count", "f.Total_amount")
vars_con <- c( "Passenger_count", "tlenkm", "Pickup_longitude", "Pickup_latitude", "Dropoff_longitude", "Dropoff_latitude","Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
for( i in vars_dis){
df[,i] <- as.factor(df[,i])
}
vars_res <- c("AnyTip", "Total_amount")
d1 <- dim(df)[1]
d2 <- dim(df)[2]
df[,d2-1] <- as.factor(df[,d2-1])
vars_cexp<-c("Passenger_count", "tlenkm", "Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
hist(df$Total_amount, 70, freq=F)
mn <- mean(df$Total_amount); ss <- sd(df$Total_amount)
curve(dnorm(x, mean = mn,sd= ss), lwd=2, lty=3, add=T)
shapiro.test(df$Total_amount)
skewness(df$Total_amount)  # Normal data should 0 - Right skewed data is present
kurtosis(df$Total_amount)  # Normal data should 3 - 5.35 >> 3
round(cor(df[,c("Total_amount",vars_cexp)], method="spearman"),dig=2)
round(cor(df[,c("Total_amount",vars_cexp)], method="pearson"),dig=2)
m <- lm( Total_amount~., data=df[,c("Total_amount",vars_cexp)])
summary(m)
Anova(m)
vif(m)  # Check association between explanatory vars
m <- step( m, k=log(nrow(df)) )
#
m <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m)
marginalModelPlots(m)
m2 <-lm(Total_amount ~  poly(tlenkm,3) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
marginalModelPlots(m2)
marginalModelPlots(m2)
m2 <-lm(Total_amount ~  poly(tlenkm,3) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
marginalModelPlots(m2)
# Example: m22a
m22a<-lm(Total_amount ~ Extra + MTA_tax + Tip_amount +
Tolls_amount + improvement_surcharge + tlenkm,data=df)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
marginalModelPlots(m2)
View(m2)
summary(m2)
View(m)
View(m)
marginalModelPlots(m2)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
#marginalModelPlots(m2)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
#marginalModelPlots(m2)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
#marginalModelPlots(m2)
summary(m2)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
#marginalModelPlots(m2)
