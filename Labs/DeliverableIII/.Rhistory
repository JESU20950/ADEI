m20 <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m20)
vif(m20)
#
m20 <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m20)
#
m <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m)
marginalModelPlots(m)
#
m <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
#marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
# Load Required Packages: to be increased over the course
options(contrasts=c("contr.treatment","contr.treatment"))
requiredPackages <- c("missMDA","chemometrics","mvoutlier","effects","FactoMineR","car", "factoextra","RColorBrewer","ggplot2","dplyr","ggmap","ggthemes","knitr","ggpubr", "corrplot", "moments")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]
if(length(missingPackages)) install.packages(missingPackages)
lapply(requiredPackages, require, character.only = TRUE)
# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
#setwd("C:/Users/carle/Desktop/ADEI2")
#filepath<-"C:/Users/carle/Desktop/ADEI2/"
setwd("~/Desktop/ADEI/Labs/DeliverableIII")
df <- read.table("Deliverable1.csv",header=T, sep=",");
vars_dis <- c("VendorID", "Payment_type", "Store_and_fwd_flag",  "RateCodeID", "f.Extra", "f.MTA_tax", "f.Improvement_surcharge", "lpep_pickup_period", "Trip_type", "lpep_pickup_date", "multiouts", "f.espeed", "f.tlenkm", "f.traveltime", "f.distHaversine", "AnyToll", "f.Fare_amount", "f.Passenger_count", "f.Total_amount")
vars_con <- c( "Passenger_count", "tlenkm", "Pickup_longitude", "Pickup_latitude", "Dropoff_longitude", "Dropoff_latitude","Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
for( i in vars_dis){
df[,i] <- as.factor(df[,i])
}
vars_res <- c("AnyTip", "Total_amount")
d1 <- dim(df)[1]
d2 <- dim(df)[2]
df[,d2-1] <- as.factor(df[,d2-1])
vars_cexp<-c("Passenger_count", "tlenkm", "Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
hist(df$Total_amount, 70, freq=F)
mn <- mean(df$Total_amount); ss <- sd(df$Total_amount)
curve(dnorm(x, mean = mn,sd= ss), lwd=2, lty=3, add=T)
shapiro.test(df$Total_amount)
skewness(df$Total_amount)  # Normal data should 0 - Right skewed data is present
kurtosis(df$Total_amount)  # Normal data should 3 - 5.35 >> 3
round(cor(df[,c("Total_amount",vars_cexp)], method="spearman"),dig=2)
round(cor(df[,c("Total_amount",vars_cexp)], method="pearson"),dig=2)
m <- lm( Total_amount~., data=df[,c("Total_amount",vars_cexp)])
summary(m)
Anova(m)  # Efectes nets
vif(m)  # Check association between explanatory vars
m <- step( m, k=log(nrow(df)) )
#
m <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m)
marginalModelPlots(m)
marginalModelPlots(m)
# Load Required Packages: to be increased over the course
options(contrasts=c("contr.treatment","contr.treatment"))
requiredPackages <- c("missMDA","chemometrics","mvoutlier","effects","FactoMineR","car", "factoextra","RColorBrewer","ggplot2","dplyr","ggmap","ggthemes","knitr","ggpubr", "corrplot", "moments")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]
if(length(missingPackages)) install.packages(missingPackages)
lapply(requiredPackages, require, character.only = TRUE)
# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
#setwd("C:/Users/carle/Desktop/ADEI2")
#filepath<-"C:/Users/carle/Desktop/ADEI2/"
setwd("~/Desktop/ADEI/Labs/DeliverableIII")
df <- read.table("Deliverable1.csv",header=T, sep=",");
vars_dis <- c("VendorID", "Payment_type", "Store_and_fwd_flag",  "RateCodeID", "f.Extra", "f.MTA_tax", "f.Improvement_surcharge", "lpep_pickup_period", "Trip_type", "lpep_pickup_date", "multiouts", "f.espeed", "f.tlenkm", "f.traveltime", "f.distHaversine", "AnyToll", "f.Fare_amount", "f.Passenger_count", "f.Total_amount")
vars_con <- c( "Passenger_count", "tlenkm", "Pickup_longitude", "Pickup_latitude", "Dropoff_longitude", "Dropoff_latitude","Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
for( i in vars_dis){
df[,i] <- as.factor(df[,i])
}
vars_res <- c("AnyTip", "Total_amount")
d1 <- dim(df)[1]
d2 <- dim(df)[2]
df[,d2-1] <- as.factor(df[,d2-1])
vars_cexp<-c("Passenger_count", "tlenkm", "Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
hist(df$Total_amount, 70, freq=F)
mn <- mean(df$Total_amount); ss <- sd(df$Total_amount)
curve(dnorm(x, mean = mn,sd= ss), lwd=2, lty=3, add=T)
shapiro.test(df$Total_amount)
skewness(df$Total_amount)  # Normal data should 0 - Right skewed data is present
kurtosis(df$Total_amount)  # Normal data should 3 - 5.35 >> 3
round(cor(df[,c("Total_amount",vars_cexp)], method="spearman"),dig=2)
round(cor(df[,c("Total_amount",vars_cexp)], method="pearson"),dig=2)
m <- lm( Total_amount~., data=df[,c("Total_amount",vars_cexp)])
summary(m)
Anova(m)  # Efectes nets
vif(m)  # Check association between explanatory vars
m <- step( m, k=log(nrow(df)) )
#
m <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
marginalModelPlots(m)
m22<-lm(Total_amount ~ Extra + MTA_tax + Tip_amount +
Tolls_amount + improvement_surcharge + poly(tlenkm,3),data=df)
m22<-lm(Total_amount ~ MTA_tax + Tip_amount +
Tolls_amount + improvement_surcharge + poly(tlenkm,3),data=df)
m22<-lm(Total_amount ~  poly(tlenkm,3) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m22)
Anova(m22)
vif(m22)
marginalModelPlots(m22)
marginalModelPlots(m22)
m2 <-lm(Total_amount ~  poly(tlenkm,3) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m22)
m2 <-lm(Total_amount ~  poly(tlenkm,3) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
marginalModelPlots(m2)
marginalModelPlots(m2)
marginalModelPlots(m2)
# Load Required Packages: to be increased over the course
options(contrasts=c("contr.treatment","contr.treatment"))
requiredPackages <- c("missMDA","chemometrics","mvoutlier","effects","FactoMineR","car", "factoextra","RColorBrewer","ggplot2","dplyr","ggmap","ggthemes","knitr","ggpubr", "corrplot", "moments")
missingPackages <- requiredPackages[!(requiredPackages %in% installed.packages()[,"Package"])]
if(length(missingPackages)) install.packages(missingPackages)
lapply(requiredPackages, require, character.only = TRUE)
# Clear plots
if(!is.null(dev.list())) dev.off()
# Clean workspace
rm(list=ls())
#setwd("C:/Users/carle/Desktop/ADEI2")
#filepath<-"C:/Users/carle/Desktop/ADEI2/"
setwd("~/Desktop/ADEI/Labs/DeliverableIII")
df <- read.table("Deliverable1.csv",header=T, sep=",");
vars_dis <- c("VendorID", "Payment_type", "Store_and_fwd_flag",  "RateCodeID", "f.Extra", "f.MTA_tax", "f.Improvement_surcharge", "lpep_pickup_period", "Trip_type", "lpep_pickup_date", "multiouts", "f.espeed", "f.tlenkm", "f.traveltime", "f.distHaversine", "AnyToll", "f.Fare_amount", "f.Passenger_count", "f.Total_amount")
vars_con <- c( "Passenger_count", "tlenkm", "Pickup_longitude", "Pickup_latitude", "Dropoff_longitude", "Dropoff_latitude","Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
for( i in vars_dis){
df[,i] <- as.factor(df[,i])
}
vars_res <- c("AnyTip", "Total_amount")
d1 <- dim(df)[1]
d2 <- dim(df)[2]
df[,d2-1] <- as.factor(df[,d2-1])
vars_cexp<-c("Passenger_count", "tlenkm", "Fare_amount", "espeed", "Tip_amount", "Tolls_amount", "lpep_pickup_time", "traveltime", "distHaversine")
hist(df$Total_amount, 70, freq=F)
mn <- mean(df$Total_amount); ss <- sd(df$Total_amount)
curve(dnorm(x, mean = mn,sd= ss), lwd=2, lty=3, add=T)
shapiro.test(df$Total_amount)
skewness(df$Total_amount)  # Normal data should 0 - Right skewed data is present
kurtosis(df$Total_amount)  # Normal data should 3 - 5.35 >> 3
round(cor(df[,c("Total_amount",vars_cexp)], method="spearman"),dig=2)
round(cor(df[,c("Total_amount",vars_cexp)], method="pearson"),dig=2)
m <- lm( Total_amount~., data=df[,c("Total_amount",vars_cexp)])
summary(m)
Anova(m)
vif(m)  # Check association between explanatory vars
m <- step( m, k=log(nrow(df)) )
#
m <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
Anova(m)
marginalModelPlots(m)
#marginalModelPlots(m)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
marginalModelPlots(m2)
marginalModelPlots(m2)
marginalModelPlots(m2)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + poly(Fare_amount,2) + poly(espeed,2) + poly(Tip_amount,2) + poly(Tolls_amount,2) +
poly(lpep_pickup_time,2) + poly(distHaversine,2),data=df)
marginalModelPlots(m2)
par(mfrow=c(2,2))
plot(m, id.n=0 )
par(mfrow=c(1,1))
par(mfrow=c(2,2))
plot(m, id.n=0)
par(mfrow=c(1,1))
plot(m, id.n=0)
View(m)
View(m)
View(m)
m <- lm( log(Total_amount) ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
m <- lm( log(Total_amount) ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df[,c("Total_amount",vars_cexp)])
log(Total_amount)
log(df$Total_amount)
summary(log(Total_amount))
summary(log(df$Total_amount))
summary(df$Total_amount)
df$Total_amount = log(dfTotal_amount)
df2$Total_amount = log(df$Total_amount)
df2 =df
df2$Total_amount = log(df$Total_amount)
m <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m)
Anova(m)
plot(m, id.n=0)
plot(m, id.n=0)
summary(log(df$Total_amount))
df2 <- df
df2$Total_amount <- log(df$Total_amount)
l <- which(df$Total_amount == -Inf)
df2[l,'Total_amount'] <- 0
m3 <- lm( Total_amount ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
Anova(m3)
plot(m3, id.n=0)
plot(m3, id.n=0)
plot(m3, id.n=0)
BIC(m,m2,m3)
summary(m2)
vif(m2)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
#marginalModelPlots(m2)
marginalModelPlots(m3)
df2 <- df
l <- which(df$Total_amount ==0 )
df2[l,'Total_amount'] <- 0.0001
m3 <- lm( log(Total_amount) ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df2)
summary(m3)
Anova(m3)
#marginalModelPlots(m3)
marginalModelPlots(m3)
plot(m3, id.n=0)
summary(m3)
marginalModelPlots(m3)
m <- step( m2, k=log(nrow(df)) )
step( m2, k=log(nrow(df)) )
lpep_pickup_time
m <- step( m3, k=log(nrow(df)) )
summary(m3)
m3 <- lm( log(Total_amount) ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
l <- which(df$Total_amount == 0 )
df[l,'Total_amount'] <- 0.0001
m3 <- lm( log(Total_amount) ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
m3 <- lm( log(Total_amount) ~ tlenkm + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
m3 <- lm( log(Total_amount) ~ tlenkm + Fare_amount + espeed + Tip_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
plot(m3, id.n=0)
plot(m3, id.n=0)
Anova(m3)
BIC(m,m2,m3)
vif(m3)
plot(allEffects(m3))
l <- which(df$Total_amount == 0 )
df[l,'Total_amount'] <- 0.0001
m3 <- lm( log(Total_amount) ~ poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
m3 <- lm( log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
Anova(m3)
vif(m3)
#marginalModelPlots(m3)
m3 <- lm( log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
Anova(m3)
vif(m3)
#marginalModelPlots(m3)
m3 <- lm( log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time, data=df)
BIC(m,m2,m3)
plot(m3, id.n=0 )
marginalModelPlots(m3)
plot(allEffects(m3))
plot(allEffects(m2))
plot(allEffects(m2))
plot(allEffects(m2))
plot(allEffects(m3))
m3 <- lm( log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time, data=df)
summary(m3)
Anova(m3)
vif(m3)
#marginalModelPlots(m3)
m3 <- lm( log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time, data=df)
summary(m3)
Anova(m3)
vif(m3)
#marginalModelPlots(m3)
plot(allEffects(m3))
BIC(m,m2,m3)
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
l <- which(df$Total_amount == 0 )
df[l,'Total_amount'] <- 0.0001
m3 <- lm( log(Total_amount) ~ poly(tlenkm,3) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
l <- which(df$Total_amount == 0 )
df[l,'Total_amount'] <- 0.0001
m3 <- lm( log(Total_amount) ~ poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
m2 <-lm(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m2)
Anova(m2)
vif(m2)
#marginalModelPlots(m2)
l <- which(df$Total_amount == 0 )
df[l,'Total_amount'] <- 0.0001
m3 <- lm( log(Total_amount) ~ poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine, data=df)
summary(m3)
m3 <- lm( log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time, data=df)
summary(m3)
Anova(m3)
vif(m3)
#marginalModelPlots(m3)
m3 <- lm( sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time, data=df)
summary(m3)
Anova(m3)
vif(m3)
#marginalModelPlots(m3)
m3 <- lm( log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount +
lpep_pickup_time, data=df)
summary(m3)
Anova(m3)
vif(m3)
#marginalModelPlots(m3)
library(MASS)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
par(mfrow=c(2,2))
plot(m25, id.n=0 )
library(MASS)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
par(mfrow=c(1,2))
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
par(mfrow=c(1,1))
library(MASS)
par(mfrow=c(1,2))
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
l <- boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
par(mfrow=c(1,1))
View(l)
library(MASS)
par(mfrow=c(1,2))
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
par(mfrow=c(1,1))
library(MASS)
par(mfrow=c(1,2))
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
boxcox(log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
BIC(m,m2,m3)
par(mfrow=c(1,1))
par(mfrow=c(1,2))
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
boxcox(log(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(MASS)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
par(mfrow=c(2,2))
plot(m25, id.n=0 )
m4 <- lm(qrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(effects)
m4 <- lm(qrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(effects)
plot(allEffects(m4))
m4 <- lm(qrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
m4 <- lm(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(effects)
plot(allEffects(m4))
plot(allEffects(m4))
m4 <- lm(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(effects)
plot(allEffects(m4))
m4 <- lm(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
library(effects)
plot(allEffects(m4))
marginalModelPlots(m4)
m4 <- lm(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
summary(m4)
Anova(m4)
vif(m4)
#marginalModelPlots(m4)
plot(allEffects(m4))
library(effects)
plot(allEffects(m4))
Anova(m4)
step( m4, k=log(nrow(df)) )
m4<-lm(sqrt(Total_amount) ~ Extra + Tip_amount + Tolls_amount + improvement_surcharge + espeed + poly(tlenkm,3) ,data=df)
influencePlot(m4,id=list(method="noteworthy", n=5, cex=0.5))
summary(resid(m4))
sel1<-Boxplot(rstudent(m4));sel1 # sel1 already contains row numbers
m4
sel1<-Boxplot(rstudent(m4));sel1 # sel1 already contains row numbers
# ll1<-which(row.names(df) %in% names(rstudent(m25)[sel1]));ll1
sel2<-which(hatvalues(m25)>6*length(m25$coefficients)/nrow(df));sel2;length(sel2) # sel2 contains row names
# ll1<-which(row.names(df) %in% names(rstudent(m25)[sel1]));ll1
sel2<-which(hatvalues(m4)>6*length(m25$coefficients)/nrow(df));sel2;length(sel2) # sel2 contains row names
summary(resid(m4))
sel1<-Boxplot(rstudent(m4));sel1 # sel1 already contains row numbers
# ll1<-which(row.names(df) %in% names(rstudent(m25)[sel1]));ll1
sel2<-which(hatvalues(m4)>6*length(m4$coefficients)/nrow(df));sel2;length(sel2) # sel2 contains row names
ll2<-which(row.names(df) %in% names(hatvalues(m4)[sel2]));ll2
sel3<-which(abs(cooks.distance(m4))>4/(nrow(df)-length(m4$coefficients)));sel3;length(sel3)
ll3<-which(row.names(df) %in% names(cooks.distance(m4)[sel3]));ll3
# sel4<-Boxplot(cooks.distance(m25));sel4  # sel4 already contains row numbers
sel3<-which((cooks.distance(m4))>0.1);sel3;length(sel3)# sel3 contains row names
influencePlot(m4,id=list(method="noteworthy", n=5, cex=0.5))
with(df,tapply(Total_amount,RateCodeID,summary))
library(MASS)
par(mfrow=c(1,2))
boxcox(Total_amount ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
boxcox(sqrt(Total_amount) ~  poly(tlenkm,2) + Fare_amount + espeed + Tip_amount + Tolls_amount +
lpep_pickup_time + distHaversine,data=df)
par(mfrow=c(1,1))
summary(resid(m4))
sel1<-Boxplot(rstudent(m4));sel1 # sel1 already contains row numbers
# ll1<-which(row.names(df) %in% names(rstudent(m25)[sel1]));ll1
sel2<-which(hatvalues(m4)>6*length(m4$coefficients)/nrow(df));sel2;length(sel2) # sel2 contains row names
ll2<-which(row.names(df) %in% names(hatvalues(m4)[sel2]));ll2
sel3<-which(abs(cooks.distance(m4))>4/(nrow(df)-length(m4$coefficients)));sel3;length(sel3)
ll3<-which(row.names(df) %in% names(cooks.distance(m4)[sel3]));ll3
# sel4<-Boxplot(cooks.distance(m25));sel4  # sel4 already contains row numbers
sel3<-which((cooks.distance(m4))>0.1);sel3;length(sel3)# sel3 contains row names
ll3<-which(row.names(df) %in% names(cooks.distance(m4)[sel3]));ll3
influencePlot(m4,id=list(method="noteworthy", n=5, cex=0.5))
with(df,tapply(Total_amount,RateCodeID,summary))
